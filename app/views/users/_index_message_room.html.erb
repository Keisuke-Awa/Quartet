<% @message_rooms.each do |mr| %>
  <%= link_to(mr.users.select_partner(current_user).name, message_room_path(mr), class: "loading-link", remote: true) %>
<% end %>
<script>

function beforeLoad() {
  document.getElementById('loading').classList.remove('loaded');
}

function completeLoad() {
  document.getElementById('loading').classList.add('loaded');
};

completeLoad();

$(".loading-link").click(function() {
  beforeLoad();
});

$("form").submit(function() {
  beforeLoad();
})

window.onload = completeLoad;
</script>